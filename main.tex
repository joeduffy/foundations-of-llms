\documentclass[11pt,oneside,openany]{book}

% Essential packages
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{geometry}
\usepackage{graphicx}
\usepackage{pdfpages}
\usepackage{hyperref}
\usepackage{bookmark}
\usepackage{fancyhdr}
\usepackage{titlesec}
\usepackage{tocloft}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{url}
\usepackage{cite}
\usepackage{setspace}
\usepackage{microtype}
% Professional font choice: Libertinus (modern, elegant serif with excellent math support)
\usepackage{libertinus}
\usepackage{libertinust1math}
\usepackage{textcomp}
\usepackage{xcolor}
\usepackage{enumitem}
\usepackage{mdframed}
\usepackage{fancyvrb}
\usepackage{fvextra}

% Enable microtypography for better text quality
\microtypesetup{protrusion=true,expansion=true,tracking=true}

% Widow and orphan control
\widowpenalty=10000
\clubpenalty=10000
\brokenpenalty=4991

% Prevent hyphenation at page breaks
\interlinepenalty=5000

% Paper summary page environment (refined academic style)
\newenvironment{papersummary}[4]{% year, title, authors, one-sentence summary
  \clearpage
  \markright{#3 (#1)}% Set running header to "Authors (Year)"
  \thispagestyle{empty}
  \vspace*{1cm}
  \begin{center}
    {\fontsize{11}{13}\selectfont\scshape #1}\\[0.8em]
    {\fontsize{18}{22}\selectfont\bfseries #2}\\[1em]
    {\fontsize{11}{13}\selectfont\itshape #3}
  \end{center}
  \vspace{0.8em}
  \begin{center}
    \rule{0.6\textwidth}{0.4pt}
  \end{center}
  \vspace{1em}
  \noindent\textit{#4}
  \vspace{1.2em}
  \begin{mdframed}[
    linewidth=0pt,
    leftline=true,
    rightline=false,
    topline=false,
    bottomline=false,
    linecolor=black!50,
    linewidth=3pt,
    backgroundcolor=black!2,
    innertopmargin=12pt,
    innerbottommargin=12pt,
    innerrightmargin=14pt,
    innerleftmargin=14pt,
    skipabove=10pt
  ]
}{%
  \end{mdframed}
  \vfill
}

\newcommand{\summaryheading}[1]{%
  \vspace{0.5em}%
  \noindent{\scshape\bfseries #1}%
  \vspace{0.3em}%
  \par\noindent%
}

% Professional page geometry for digital reading
\geometry{
    paperwidth=7in,
    paperheight=10in,
    left=1in,
    right=1in,
    top=1in,
    bottom=1in,
    headheight=24pt,
    headsep=18pt,
    footskip=24pt
}

% Line spacing
\onehalfspacing

% Enhanced headers and footers
\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{\small\textsc{\nouppercase{\leftmark}}}
\fancyhead[R]{\small\thepage}
\fancyfoot[C]{}
\renewcommand{\headrulewidth}{0.3pt}
\renewcommand{\footrulewidth}{0pt}

% Customize chapter and part marks to avoid duplication
\renewcommand{\chaptermark}[1]{\markboth{#1}{}}
\renewcommand{\partmark}[1]{\markboth{\partname\ \thepart: #1}{}}

% Chapter formatting - Springer style
\titleformat{\chapter}[display]
  {\normalfont\Large\bfseries\centering}
  {\MakeUppercase{\chaptertitlename}\ \thechapter}
  {12pt}
  {\huge\bfseries}
\titlespacing*{\chapter}{0pt}{40pt}{30pt}

% Part formatting - dramatic full-page treatment
\titleformat{\part}[display]
  {\normalfont\centering}
  {\vspace*{2cm}\rule{0.5\textwidth}{0.5pt}\\[1em]%
   {\fontsize{14}{16}\selectfont\scshape\partname}\\[0.3em]%
   {\fontsize{72}{80}\selectfont\textcolor{black!25}{\thepart}}\\[0.5em]%
   \rule{0.5\textwidth}{0.5pt}}
  {40pt}
  {\fontsize{28}{34}\selectfont\bfseries}
\titlespacing*{\part}{0pt}{0pt}{40pt}

% Section formatting
\titleformat{\section}
  {\normalfont\large\bfseries}
  {\thesection}
  {1em}
  {}
\titlespacing*{\section}{0pt}{18pt plus 4pt minus 2pt}{12pt plus 2pt minus 2pt}

% Subsection formatting
\titleformat{\subsection}
  {\normalfont\normalsize\bfseries}
  {\thesubsection}
  {1em}
  {}
\titlespacing*{\subsection}{0pt}{12pt plus 3pt minus 1pt}{8pt plus 1pt minus 1pt}

% Enhanced table of contents
\renewcommand{\cftpartfont}{\Large\bfseries}
\renewcommand{\cftchapfont}{\normalsize\bfseries}
\renewcommand{\cftsecfont}{\normalsize}
\renewcommand{\cftsubsecfont}{\small}
\renewcommand{\cftpartpagefont}{\Large\bfseries}
\renewcommand{\cftchappagefont}{\normalsize\bfseries}
\renewcommand{\cftsecpagefont}{\normalsize}
\renewcommand{\cftsubsecpagefont}{\small}
\setlength{\cftbeforepartskip}{12pt}
\setlength{\cftbeforechapskip}{6pt}
\setlength{\cftbeforesecskip}{3pt}
\setlength{\cftbeforesubsecskip}{2pt}
\setlength{\cftsubsecindent}{1.5em}

% Dotted leaders for all TOC levels
\renewcommand{\cftpartleader}{\cftdotfill{\cftdotsep}}
\renewcommand{\cftchapleader}{\cftdotfill{\cftdotsep}}
\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}}
\renewcommand{\cftsubsecleader}{\cftdotfill{\cftdotsep}}

% List formatting
\setlist[enumerate]{itemsep=3pt,parsep=0pt,topsep=6pt}
\setlist[itemize]{itemsep=3pt,parsep=0pt,topsep=6pt}

% Hyperref setup - professional styling with enhanced navigation
\hypersetup{
    pdftitle={The Foundations of Large Language Models, 1943-2025},
    pdfauthor={A Curated Collection},
    pdfsubject={Artificial Intelligence, Machine Learning, Natural Language Processing},
    pdfkeywords={Large Language Models, Transformers, Neural Networks, AI, Deep Learning},
    colorlinks=true,
    linkcolor=blue!70!black,
    citecolor=blue!70!black,
    urlcolor=blue!80!black,
    bookmarksnumbered=true,
    bookmarksopen=true,
    pdfpagemode=UseOutlines,
    pdfdisplaydoctitle=true,
    linktoc=all
}

% Professional title page with neural network graphic
\usepackage{tikz}
\usetikzlibrary{positioning,shapes.geometric,arrows.meta,calc}

\makeatletter
\renewcommand{\maketitle}{%
  \begin{titlepage}%
    \let\footnotesize\small
    \let\footnoterule\relax
    \let \footnote \thanks
    \null\vfil
    \vskip 40\p@
    \begin{center}%
      % Subtle neural network diagram
      \begin{tikzpicture}[scale=0.6, transform shape]
        \tikzset{
          neuron/.style={circle, draw=black!30, fill=black!5, minimum size=8pt, inner sep=1pt},
          connection/.style={draw=black!20, line width=0.5pt}
        }
        % Input layer
        \foreach \y in {1,2,3,4} {
          \node[neuron] (I\y) at (0,\y) {};
        }
        % Hidden layers
        \foreach \y in {1,2,3,4,5} {
          \node[neuron] (H1\y) at (2,\y+0.5) {};
        }
        \foreach \y in {1,2,3,4,5,6} {
          \node[neuron] (H2\y) at (4,\y+0.25) {};
        }
        \foreach \y in {1,2,3,4} {
          \node[neuron] (H3\y) at (6,\y+0.5) {};
        }
        % Output layer
        \foreach \y in {1,2,3} {
          \node[neuron] (O\y) at (8,\y+1) {};
        }
        % Connections (subset for visual clarity)
        \foreach \i in {1,2,3,4} {
          \foreach \j in {1,3,5} {
            \draw[connection] (I\i) -- (H1\j);
          }
        }
        \foreach \i in {1,3,5} {
          \foreach \j in {2,4,6} {
            \draw[connection] (H1\i) -- (H2\j);
          }
        }
        \foreach \i in {2,4,6} {
          \foreach \j in {1,3} {
            \draw[connection] (H2\i) -- (H3\j);
          }
        }
        \foreach \i in {1,3} {
          \foreach \j in {1,2,3} {
            \draw[connection] (H3\i) -- (O\j);
          }
        }
      \end{tikzpicture}\\[24pt]
      {\fontsize{20}{24}\selectfont\bfseries\MakeUppercase{The Foundations of}}\\[12pt]
      {\fontsize{24}{28}\selectfont\bfseries\MakeUppercase{Large Language Models}}\\[18pt]
      {\fontsize{16}{20}\selectfont\bfseries 1943 -- 2025}\\[36pt]
      {\large A Curated Collection of Seminal Papers}\\[24pt]
      \vskip 2em%
      {\large in}\\[12pt]
      {\Large\bfseries Artificial Intelligence \& Machine Learning}\\[48pt]
      \vfill
      {\large Compiled for the Scientific Community}\\[4pt]
      {\normalsize\textcolor{black!60}{by Joe Duffy \texttt{<joeduffy@acm.org>}}}\\[6pt]
    \end{center}\par
    \@thanks
    \vfil\null
  \end{titlepage}%
  \setcounter{footnote}{0}%
  \global\let\thanks\relax
  \global\let\maketitle\relax
  \global\let\@thanks\@empty
  \global\let\@author\@empty
  \global\let\@date\@empty
  \global\let\@title\@empty
  \global\let\title\relax
  \global\let\author\relax
  \global\let\date\relax
  \global\let\and\relax
}
\makeatother

% Special page styles
\fancypagestyle{plain}{%
  \fancyhf{}%
  \fancyfoot[C]{\small\thepage}%
  \renewcommand{\headrulewidth}{0pt}%
  \renewcommand{\footrulewidth}{0pt}%
}

% Clean page style for included PDFs (no headers/footers)
\fancypagestyle{empty}{%
  \fancyhf{}%
  \renewcommand{\headrulewidth}{0pt}%
  \renewcommand{\footrulewidth}{0pt}%
}

\begin{document}

% Front matter
\frontmatter
\maketitle

% Frontispiece: microGPT — the complete algorithm on one page
\input{content/microgpt}

% Table of Contents
\cleardoublepage
\phantomsection
\markboth{Contents}{Contents}
\setcounter{tocdepth}{2}  % Show parts, chapters, and subsections
\tableofcontents
\cleardoublepage

% Prologue
\input{content/prologue}

% Main content
\mainmatter

% Part I: Neural Beginnings & Learning Mechanisms (1943–1990)
\part{Neural Beginnings \& Learning Mechanisms\\1943--1990}
\input{content/part1-chapter}

% Part II: Sequence Models & Word Embeddings (1990–2013)
\part{Sequence Models \& Word Embeddings\\1990--2013}
\input{content/part2-chapter}

% Part III: Deep Learning & Attention (2012–2015)
\part{Deep Learning \& Attention\\2012--2015}
\input{content/part3-chapter-new}

% Part IV: The Transformer Era and Pretraining Revolution (2017–2019)
\part{The Transformer Era and Pretraining Revolution\\2017--2019}
\input{content/part4-chapter-new}

% Part V: Emergence and Scale (2019–2020)
\part{Emergence and Scale\\2019--2020}
\input{content/part5-chapter-new}

% Part VI: Efficiency, Alignment, and Reasoning (2021–2022)
\part{Efficiency, Alignment, and Reasoning\\2021--2022}
\input{content/part6-chapter-new}

% Part VII: Open LLMs and Modern Frontier (2023–2024)
\part{Open LLMs and Modern Frontier\\2023--2024}
\input{content/part7-chapter-new}

% Appendices
\appendix

% Appendix A: Emerging Results (2023–2024)
\chapter{Emerging Results (2023--2024)}
\input{content/appendix-a-chapter}

% Appendix B: Foundations of Agents (2022–2025)
\chapter{Foundations of Agents (2022--2025)}
\input{content/appendix-b-chapter}

% Appendix C: System Reports & Production Breakthroughs (2023–2025)
\chapter{System Reports \& Production Breakthroughs (2023--2025)}
\input{content/appendix-c-chapter}

% Back matter
\backmatter

% Epilogue
\input{content/epilogue}

\end{document}